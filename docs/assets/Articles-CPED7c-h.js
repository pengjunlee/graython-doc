var de=Object.defineProperty;var pe=(o,t,e)=>t in o?de(o,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):o[t]=e;var j=(o,t,e)=>(pe(o,typeof t!="symbol"?t+"":t,e),e);import{a as me,b as ve,c as _e,d as fe,e as ye,f as he}from"./element-plus-BJNhNJy6.js";import{u as ge}from"./vue-router-BKcYu3e2.js";import{f as be,ac as we,r as c,d as X,_ as z,o as y,c as w,B as d,C as h,V,G as E,u as r,A as ke,a as n,F as S,O as G,L as F,$ as J,n as Z,a9 as Se,aa as xe,E as Q,K as Ce}from"./@vue-DeiGdm1c.js";import{p as Ee,m as Te,d as ze,e as Ie}from"./@element-plus-D2ZrbeLh.js";/* empty css              */import{i as D,g as Le,_ as ee,a as Ae,b as Ne}from"./index-21Q7FUYp.js";import{a as Be}from"./axios-Cm0UX6qg.js";import"./@ctrl-D_sRHO8g.js";import"./@vueuse-BYe3nKFQ.js";import"./lodash-es-B8hPxd1J.js";import"./pinia-CkjTwEMl.js";const Re=(o,t)=>{let e=!1;be(()=>{e||o()}),we(()=>{e&&t(),e=!0})},Oe="blossom_web_",M={set(o,t){window.localStorage.setItem(P(o),JSON.stringify(t))},get(o){let t=window.localStorage.getItem(P(o));return JSON.parse(t)},remove(o){window.localStorage.removeItem(P(o))},clear(){window.localStorage.clear()}},P=o=>Oe+o,$="BLOSSOM-ARTICLE-FONT-SZIE",C=c(M.get($)||.9),je=()=>{C.value+=.1,M.set($,C.value)},Fe=()=>{C.value-=.1,M.set($,C.value)},Pe=()=>C.value,Y=()=>C.value+"rem",Ve=o=>{let t=o.querySelectorAll("h1, h2, h3, h4, h5, h6"),e=[];for(let a=0;a<t.length;a++){let u=t[a],i=1,l=u.innerText,_=u.id;switch(u.localName){case"h1":i=1;break;case"h2":i=2;break;case"h3":i=3;break;case"h4":i=4;break;case"h5":i=5;break;case"h6":i=6;break}let x={content:l,clazz:"toc-"+i,id:_};e.push(x)}return e},De=o=>{let t=document.getElementById(o);t==null||t.scrollIntoView(!0)},Me=o=>D(o.icon)&&(o.icon.startsWith("http")||o.icon.startsWith("https")),$e=o=>D(o.icon),qe=o=>{let t=[];return o.t.forEach(e=>{e.toLocaleLowerCase()==="subject"?t.unshift({content:"专题",bgColor:"#565656",icon:"bl-a-lowerrightpage-line"}):e.toLocaleLowerCase()==="toc"?t.push({content:"目录",bgColor:"#939393"}):t.push({content:e})}),t},We=(o,t,e,a,u)=>{if(a==="copyPreCode"){let i=document.getElementById(u);if(i){if(navigator.clipboard&&window.isSecureContext)return navigator.clipboard.writeText(i.innerText);{let l=document.createElement("textarea");return l.value=i.innerText,l.style.position="absolute",l.style.opacity="0",l.style.left="-999999px",l.style.top="-999999px",document.body.appendChild(l),l.focus(),l.select(),new Promise((_,x)=>{document.execCommand("copy")?_():x(),l.remove()})}}}},Ke=Le();class Ue{constructor(t){j(this,"instance");j(this,"baseConfig",{baseURL:Ke,timeout:6e4});this.instance=Be.create(Object.assign(this.baseConfig,t)),this.instance.interceptors.request.use(e=>e,e=>Promise.reject(e)),this.instance.interceptors.response.use(e=>{const a=e.status;debugger;return a!==200&&Promise.reject(e),e.data?e.data:{html:'<div style="color:#E3E3E3;width:100%;height:300px;display:flex;justify-content: center;align-items: center;font-size:25px;">文章不存在</div>'}},e=>{let a=e.message;return e.code==="ERR_NETWORK"&&(a="网络错误,请检查您的网络是否通畅"),me({message:a}),Promise.reject(e)})}request(t){return this.instance.request(t)}get(t,e){return this.instance.get(t,e)}post(t,e,a){return this.instance.post(t,e,a)}delete(t,e){return this.instance.delete(t,e)}getFile(t){return this.instance.get(t)}}const te=new Ue,He=o=>te.getFile("/docTree"),Ge=o=>te.getFile("/_post/"+o+"/doc.html"),Je={class:"detail"},Ze=X({__name:"ArticleSetting",setup(o){return(t,e)=>{const a=z("bl-tag"),u=ve,i=z("bl-row");return y(),w("div",Je,[d(i,null,{default:h(()=>[V(" 文章字体大小： "),d(a,{style:{"margin-right":"15px"}},{default:h(()=>[V(E(r(Pe)().toFixed(1)),1)]),_:1}),d(u,{size:"small",icon:r(Ee),onClick:e[0]||(e[0]=l=>r(je)())},null,8,["icon"]),d(u,{size:"small",icon:r(Te),onClick:e[1]||(e[1]=l=>r(Fe)())},null,8,["icon"])]),_:1})])}}}),Qe=ee(Ze,[["__scopeId","data-v-75d33a22"]]),T=o=>(Se("data-v-ae58ef48"),o=o(),xe(),o),Ye={class:"articles-root"},Xe={class:"headmenu"},et=T(()=>n("div",{class:"iconbl bl-model-line"},null,-1)),tt=T(()=>n("div",{style:{"font-size":"0.8rem"}},"文章列表",-1)),ot=T(()=>n("div",{style:{"font-size":"0.8rem"}},"目录",-1)),st=T(()=>n("div",{class:"iconbl bl-list-ordered"},null,-1)),nt={class:"main"},lt={class:"doc-name"},at=["src"],it={key:1,class:"icon menu-icon","aria-hidden":"true"},ct=["xlink:href"],rt={class:"article-name"},ut=["innerHTML"],dt={class:"viewer-toc"},pt={key:0,class:"doc-info"},mt=T(()=>n("div",{class:"toc-title"},"目录",-1)),vt={class:"toc-content"},_t=["onClick"],ft=X({__name:"Articles",setup(o){Re(()=>{window.onHtmlEventDispatch=We,e(),window.addEventListener("resize",B),H()},()=>{e(),window.addEventListener("resize",B),H()}),ke(()=>{window.removeEventListener("resize",B)});const t=c(),e=()=>{let s=a.query.articleId;oe(()=>{Z(()=>{t.value.setCurrentKey(i.value)})}),Ae(s)&&(i.value=s,W({ty:3,i:s}))},a=ge(),u=c(!0),i=c(""),l=c([]),_=c({id:0,pid:0,name:"",tags:[],sort:0,starStatus:0,openStatus:0,type:3,html:`<div style="color:#E3E3E3;width:100%;height:300px;display:flex;justify-content: center;
    align-items: center;font-size:25px;">请在左侧菜单选择文章</div>`}),x=c([]),q=c([]),I=c(),oe=s=>{u.value=!0,l.value=[],q.value=[];const p=m=>{debugger;l.value=m,l.value.forEach(R=>{q.value.push(R.i.toString())}),s&&s()};He().then(m=>p(m)).finally(()=>u.value=!1)},W=async s=>{s.ty==3&&(await se(s.i),window.history.replaceState("","","#/articles?articleId="+s.i),Z(()=>{I.value.scrollTo({top:0}),ne(I.value)}))},se=async s=>{const p=m=>{Ne(m)||(_.value=m)};await Ge(s).then(m=>p(m))},ne=async s=>{x.value=Ve(s)},L=c(!1),le=()=>{L.value=!0},k=c({display:"none"}),A=c(!1),g=c({display:"none",opacity:0}),N=c(!1),b=c({display:"none",opacity:0}),K=s=>{A.value=s,s&&(k.value={display:"block"},g.value={display:"block",opacity:0},setTimeout(()=>{g.value={display:"block",opacity:1}},1)),s||(g.value={display:"block",opacity:0},setTimeout(()=>{g.value={display:"none",opacity:0}},300))},U=s=>{N.value=s,s&&(k.value={display:"block"},b.value={display:"block",opacity:0},setTimeout(()=>{b.value={display:"block",opacity:1}},1)),s||(b.value={display:"block",opacity:0},setTimeout(()=>{b.value={display:"none",opacity:0}},300))},H=()=>{let s=document.body.clientWidth;s>1100&&(g.value={display:"block",opacity:1}),s>1100&&(k.value={display:"none"},b.value={display:"block",opacity:1})},ae=()=>{K(!1),U(!1),k.value={display:"none"}},B=()=>{let s=document.body.clientWidth;s<1100&&(A.value=!1,g.value={display:"none",opacity:0}),s>1100&&(k.value={display:"none"},g.value={display:"block",opacity:1}),s<1100&&(N.value=!1,b.value={display:"none",opacity:0}),s>1100&&(k.value={display:"none"},b.value={display:"block",opacity:1})};return(s,p)=>{const m=z("bl-row"),R=z("bl-tag"),ie=_e,ce=fe,re=ye,ue=he;return y(),w(F,null,[n("div",Ye,[n("div",{class:"mask",style:S(k.value),onClick:ae},null,4),n("div",Xe,[d(m,{onClick:p[0]||(p[0]=f=>K(!A.value))},{default:h(()=>[et,tt]),_:1}),d(m,{just:"flex-end",onClick:p[1]||(p[1]=f=>U(!N.value))},{default:h(()=>[ot,st]),_:1})]),n("div",nt,[n("div",{class:"doc-tree-container",style:S(g.value)},[d(ie,{ref_key:"DocTreeRef",ref:t,class:"doc-tree",data:l.value,"highlight-current":!0,indent:14,icon:r(ze),"node-key":"i",onNodeClick:W},{default:h(({_node:f,data:v})=>[n("div",{class:"menu-item-wrapper",style:S({marginTop:v.p==="0"?"5px":"1px",marginBottom:v.p==="0"?"5px":"1px"})},[n("div",{class:Q([(v.t.includes("subject"),"doc-title")])},[n("div",lt,[r(Me)(v)?(y(),w("img",{key:0,class:"menu-icon-img",src:v.icon},null,8,at)):r($e)(v)?(y(),w("svg",it,[n("use",{"xlink:href":"#"+v.icon},null,8,ct)])):G("",!0),n("div",{class:"name-wrapper",style:S({maxWidth:r(D)(v.icon)?"calc(100% - 25px)":"100%"})},E(v.n),5),(y(!0),w(F,null,J(r(qe)(v),O=>(y(),Ce(R,{"bg-color":O.bgColor,icon:O.icon},{default:h(()=>[V(E(O.content),1)]),_:2},1032,["bg-color","icon"]))),256))])],2)],4)]),_:1},8,["data","icon"])],4),n("div",{class:"doc-content-container",ref_key:"PreviewRef",ref:I,style:S({fontSize:r(Y)()})},[n("div",rt,E(_.value.name),1),d(ce,{font:{color:"rgba(157, 157, 157, 0.2)",fontSize:"13",textBaseline:"hanging"},content:_.value.id>0?"Graython":"",gap:[250,250]},{default:h(()=>[n("div",{class:"bl-preview",style:S({fontSize:r(Y)()}),innerHTML:_.value.html},null,12,ut)]),_:1},8,["font","content"])],4),n("div",{class:"toc-container",style:S(b.value)},[n("div",dt,[_.value.id!=0?(y(),w("div",pt)):G("",!0),mt,n("div",vt,[(y(!0),w(F,null,J(x.value,f=>(y(),w("div",{key:f.id,class:Q(["toc-item","link",f.clazz]),onClick:v=>r(De)(f.id)},E(f.content),11,_t))),128))])])],4),n("div",{class:"module-workbench",onClick:le},[d(re,{color:"#7b7b7ba9"},{default:h(()=>[d(r(Ie))]),_:1})])])]),d(ue,{modelValue:L.value,"onUpdate:modelValue":p[2]||(p[2]=f=>L.value=f),class:"center-drawer",direction:"btt","close-on-click-modal":!0,"with-header":!0,"destroy-on-close":!0,size:"70px"},{default:h(()=>[d(Qe)]),_:1},8,["modelValue"])],64)}}}),It=ee(ft,[["__scopeId","data-v-ae58ef48"]]);export{It as default};
